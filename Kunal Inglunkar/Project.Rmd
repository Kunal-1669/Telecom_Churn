---
title: "project"
output: html_document
date: "2022-10-22"
---

```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
library(tidyverse)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
library(readr)
library(ggplot2)
<<<<<<< Updated upstream
install.packages(plotly)
install.packages("data.table")
=======
#install.packages(plotly)
#install.packages("data.table")
>>>>>>> Stashed changes
library(plotly)
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```
```{r}
<<<<<<< Updated upstream
adata<-read.csv("Telecom Data.csv")
```
## Including Plots
```{r}
summary(adata)
=======
Telecom_Data<-read.csv("Telecom Data.csv")
```
## Including Plots
```{r}
summary(Telecom_Data)
>>>>>>> Stashed changes
```
You can also embed plots, for example:
```{r}
#adata$NonUSTravel<-as.factor(adata$NonUSTravel)
```
```{r}
#adata$NonUSTravel<-ifelse(adata$NonUSTravel=='Yes',1,0)
<<<<<<< Updated upstream
ustravel1=adata[which(adata$NonUSTravel=="Yes"),]

ustravel1<-adata
=======
ustravel1=Telecom_Data[which(Telecom_Data$NonUSTravel=="Yes"),]

ustravel1<-Telecom_Data
>>>>>>> Stashed changes
#ustravel1$NonUSTravel<-as.factor(ustravel$NonUSTravel)
#ustravel1<-ifelse(ustravel$NonUSTravel=="Yes",1,0)
```
```{r}

ustravel1$NonUSTravel<-as.factor(ustravel1$NonUSTravel)
```

```{r}
ustravel1$NonUSTravel<-ifelse(ustravel1$NonUSTrave=="Yes",1,0)
```
```{r}
ustravel1$NonUSTravel<-as.integer(ustravel1$NonUSTravel)
```
```{r}
<<<<<<< Updated upstream
pie(ustravel1$NonUSTravel)
```

```{r}
churned<-adata[which(adata$Churn=="Yes"),]
```

```{r}
not_churned<-adata[which(adata$Churn=="No"),]
=======
#pie(ustravel1$NonUSTravel)
```

```{r}
churned<-Telecom_Data[which(Telecom_Data$Churn=="Yes"),]
```

```{r}
not_churned<-Telecom_Data[which(Telecom_Data$Churn=="No"),]
>>>>>>> Stashed changes
```
```{r}
typeof(churned$NonUSTravel)
```

```{r}
ggplot(churned,aes(x=NonUSTravel,))+geom_bar(color="blue",fill="steelblue",width=0.5)+ggtitle("Churned ")
ggplot(not_churned,aes(x=NonUSTravel,))+geom_bar(color="blue",fill="steelblue",width=0.5)+ggtitle("Not Churned")
```
```{r}
<<<<<<< Updated upstream
churn_count<-nrow(adata$Churn)
ggplot(adata,aes(x = NonUSTravel,fill=Churn )) +
=======
churn_count<-nrow(Telecom_Data$Churn)
ggplot(Telecom_Data,aes(x = NonUSTravel,fill=Churn )) +
>>>>>>> Stashed changes
geom_bar( position = "stack")+ggtitle("How Travel affects churn")
```
```{r}

<<<<<<< Updated upstream
 churn_count<-nrow(adata$Churn)
ggplot(ustravel,aes(x = NonUSTravel,fill=Churn )) +
geom_bar( position = "dodge")+ggtitle("How Travel affects churn")
=======
 churn_count<-nrow(Telecom_Data$Churn)
#ggplot(ustravel,aes(x = NonUSTravel,fill=Churn )) +
#geom_bar( position = "dodge")+ggtitle("How Travel affects churn")
>>>>>>> Stashed changes
```



```{r}
ggplot(churned,aes(MonthsInService),)+geom_bar()
```
```{r pressure, echo=FALSE}
<<<<<<< Updated upstream
table1<-table(adata$Churn,adata$NonUSTravel)
=======
table1<-table(Telecom_Data$Churn,Telecom_Data$NonUSTravel)
>>>>>>> Stashed changes
```

```{r}
table2<-100*prop.table(table1)
barplot(table2,ylim=c(0,100),legend=TRUE)
```
```{r}

```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.




```{r}
<<<<<<< Updated upstream
Churned <- subset(adata, Churn=="Yes")
str(Churned)
Retained <- subset(adata, Churn=="No")
=======
Churned <- subset(Telecom_Data, Churn=="Yes")
str(Churned)
Retained <- subset(Telecom_Data, Churn=="No")
>>>>>>> Stashed changes
str(Retained)
set.seed(321) # just so that everyone have the same sample for comparison
Retained_sample = Retained[ sample(nrow(Retained),14711), ]

Final=union(Churned,Retained_sample)
```

```{r}
<<<<<<< Updated upstream

colors <- c('rgb(211,94,96)', 'rgb(128,133,133)', 'rgb(144,103,167)', 'rgb(171,104,87)', 'rgb(114,147,203)')


fig <- plot_ly(type='pie', labels=ustravel$NonUSTravel, values=Churned$n,
               textinfo='label+percent',
               insidetextorientation='radial',marker = list(colors = colors,
                      line = list(color = '#FFFFFF', width = 1)))
fig
=======
#library(plotly)
#colors <- c('rgb(211,94,96)', 'rgb(128,133,133)', 'rgb(144,103,167)', 'rgb(171,104,87)', 'rgb(114,147,203)')


#fig <- plot_ly(type='pie', labels=ustravel$NonUSTravel, values=Churned$n,
#               textinfo='label+percent',
#               insidetextorientation='radial',marker = list(colors = colors,
 #                     line = list(color = '#FFFFFF', width = 1)))
#fig
>>>>>>> Stashed changes

```
```{r}
library(plotly)
#colors <- c(col="aquamarine3",'red', alpha=0.2)
#c('rgb(211,94,96)', 'rgb(128,133,133)', 'rgb(144,103,167)', 'rgb(171,104,87)', 'rgb(114,147,203)')
colors <- c('rgb(211,94,96)', 'rgb(128,133,133)', 'rgb(144,103,167)', 'rgb(171,104,87)', 'rgb(114,147,203)')
fig <- plot_ly(type='pie', labels=ustravel$Churn, values=ustravel$n,
               textinfo='label+percent',
               insidetextorientation='radial',marker = list(colors = colors,
                      line = list(color = '#FFFFFF', width = 1)))
fig
```

```{r}
ustravel$NonUSTravel
```

```{r}
ggplot(Final,aes(x = NonUSTravel,fill=Churn )) +
geom_bar( position = "stack")+ggtitle("How Travel affects churn (after sampling)")
```